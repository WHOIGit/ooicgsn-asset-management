The functions collected here were written in Matlab to generate OOI csv calfiles on Windows systems. They were initially incorporated into a turn-triggered (as opposed to an intrument-received) batch processing asset management tracking scheme so that the "import" code would unzip files downloaded from Vault and condition the unzipped filenames as needed for input into the csv generation programs. "Export" code was written to call the csv generation code and to display source file and/or pdf contents and csv calfile coefficients to the screen for documentation consistency checks.

The csv generation files have been updated (May 2023) to include the screen checks that were formerly in the export code scripts. Typically the csv generation files execute a Matlab system call to open the newly generated csv file in notepad.exe for its contents to be displayed on the computer monitor; this automatically introduces a "pause" to Matlab execution which will resume when the notepad window is closed. Concurrently either a Wordpad window (C:\Windows\System32\write.exe) will be opened to display a text file (eg, QCT file) or pdf files displayed for numerical checks. 

Batch processing has been disabled in the current generation csv code. The csv code requires that the source documentation be in the current Matlab working directory which is where the newly generated csv calfile will be generated. Some pieces of the import code have been retained as is for those who might want to reconstruct batch processing pathways.

Some of the instrument classes have code written for them to provide supplementary checks; these script names will start with "compare". They require that all the relevant files reside in the working directory. Some (ctdbp, metctd) will display each coefficient in the Matlab command window along with the |maximum deviation| / mean. Any result worse than single precision should be investigated.

NUTNR and OPTAA cases have special code which writes out an excel check file with 3 worksheets. The vendor file (calfile for NUTNR, devfile for OPTAA) is imported to the 1st worksheet, the corresponding csv calfile(s) imported into the 3rd worksheet, and difference formulas written to the middle 'testbed' sheet over a background of the vendor doc file. Autofilling the cells in the testbed sheet will result in differences of '0' or comparisons of 'True' when the entries match. (A digital "watermark" of alternating differences of +\- 1.e-7 will also be observed.) The 'actxserver' routines in the folder xlsxFunctions provide part of the functionality needed to create these xlsx file checks.



